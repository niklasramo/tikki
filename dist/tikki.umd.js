!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("eventti")):"function"==typeof define&&define.amd?define(["exports","eventti"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).tikki={},e.eventti)}(this,(function(e,t){"use strict";const{r:i,c:s}=(()=>{if("function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame)return{r:e=>requestAnimationFrame(e),c:e=>cancelAnimationFrame(e)};{const e=1e3/60,t="undefined"==typeof performance?()=>Date.now():()=>performance.now();return{r:i=>setTimeout((()=>i(t())),e),c:e=>clearTimeout(e)}}})();var n;e.AutoTickState=void 0,(n=e.AutoTickState||(e.AutoTickState={}))[n.OFF=0]="OFF",n[n.ON=1]="ON",n[n.PAUSED=2]="PAUSED";e.Ticker=class{constructor(n={}){const{phases:o=[],autoTick:r=e.AutoTickState.ON,allowDuplicateListeners:c=!0,idDedupeMode:u="replace",requestTick:a=i,cancelTick:h=s}=n;this.phases=o,this.allowDuplicateListeners=c,this._autoTick=r,this._autoTickId=null,this._requestTick=a,this._cancelTick=h,this._emitter=new t.Emitter({allowDuplicateListeners:c,idDedupeMode:u}),this._queue=[],this.tick=this.tick.bind(this)}get autoTick(){return this._autoTick}set autoTick(t){t===e.AutoTickState.ON?this._emitter.listenerCount()&&this._requestFrame():this._cancelFrame(),this._autoTick=t}get idDedupeMode(){return this._emitter.idDedupeMode}set idDedupeMode(e){this._emitter.idDedupeMode=e}tick(e){this._autoTickId=null;const{_queue:t}=this;if(t.length)throw new Error("Can't tick before the previous tick has finished.");this._requestFrame();const{phases:i,_emitter:s}=this;let n,o,r,c,u,a;for(n=0,r=i.length;n<r;n++)a=s._getListeners(i[n]),a&&t.push(a);for(n=0,r=t.length;n<r;n++)for(u=t[n],o=0,c=u.length;o<c;o++)u[o](e);t.length=0,null===this._autoTickId||s.listenerCount()||this._cancelFrame()}on(e,t,i){const s=this._emitter.on(e,t,i);return this._requestFrame(),s}once(e,t,i){const s=this._emitter.once(e,t,i);return this._requestFrame(),s}off(e,t){return this._emitter.off(e,t)}listenerCount(e){return this._emitter.listenerCount(e)}_requestFrame(){this._autoTick===e.AutoTickState.ON&&null===this._autoTickId&&(this._autoTickId=this._requestTick(this.tick))}_cancelFrame(){null!==this._autoTickId&&(this._cancelTick(this._autoTickId),this._autoTickId=null)}},Object.defineProperty(e,"__esModule",{value:!0})}));